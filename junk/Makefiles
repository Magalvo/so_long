NAME = so_long
SRCS = main.c
OBJS = $(SRCS:.c=.o)

D_SRCS = $(addprefix $(DRAW_DIR)/,$(addsuffix .c, $(D)))
D = aux_func draw images map_draw sprites
DRAW_DIR = draw
D_OBJS = $(D_SRCS:.c=.o)

S_SRCS = $(addprefix $(SRCS_DIR)/,$(addsuffix .c, $(S)))
S = flood_fill read_map map_check
SRCS_DIR = maps
S_OBJS = $(S_SRCS:.c=.o)

CC = cc
CFLAGS = -g -Wall -Wextra -Werror

MLX = $(MLX_DIR)/libmlx_Linux.a -lX11 -lXext
MLX_DIR = minilibx-linux

LIBFTDIR = ./lib
LIBFT = $(LIBFTDIR)/libft.a

PRINTFDIR = ./custom/ft_printf
PRINTF = $(PRINTFDIR)/libftprintf.a

GETNLDIR = ./custom/get_next_line
GETNL = $(GETNLDIR)/getnextline.a

all: $(NAME)

.c.o:
	$(CC) $(CFLAGS) -c $< -o $(<:.c=.o)

$(NAME): $(LIBFT) $(SRCS) $(S_OBJS) $(D_OBJS) $(MLX)
	@$(CC) -o $(NAME) $(MLX) $(OBJS) $(LIBFT) $(PRINTF) $(GETNL)

$(LIBFT):
	@$(MAKE) -C $(LIBFTDIR) --no-print-directory

$(PRINTF):
	@$(MAKE) -C $(PRINTFDIR) --no-print-directory

$(GETNL):
	@$(MAKE) -C $(GETNLDIR) --no-print-directory

$(MLX):
	$(MAKE) -C $(MLX_DIR)

clean:
	@$(RM) $(OBJS)
	@$(MAKE) -C $(LIBFTDIR) clean --no-print-directory
	@$(MAKE) -C $(MLX_DIR) clean --no-print-directory

fclean: clean
	@$(RM) $(NAME) $(BONUS_NAME)
	@$(MAKE) -C $(LIBFTDIR) fclean --no-print-directory

re: fclean all
